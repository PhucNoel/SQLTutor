<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<f:event type="preRenderView" listener="#{freeEntryPageBean.devRedirect}" />
<h:head>
	<title>SQL Tutor</title>
	<ui:insert name="menu">
		<ui:include src="/samples/template-menubar.xhtml" />
	</ui:insert>
</h:head>
<h:body style="height:1000px;width:1200px">
	<h:form id="freeEntryForm">
		<div style="position:absolute;width:400;height:400;top:auto;left:0">
			<p:panelGrid columns="2">
				<f:facet name="header">  
				    Add Query
				</f:facet>
				<p:outputLabel for="query" value="Enter Query: " />
				<p:inputTextarea rows="3" cols="35" id="query" reRender="results"
					autoResize="false" style="resize:none" value="#{freeEntryPageBean.query}" 
					requiredMessage="Query entry is required." />
					
				<h:outputLabel for="userDescription" value="English description: " />
				<p:inputTextarea rows="3" cols="35" id="userDescription" required="true" style="resize:none"
						value="#{freeEntryPageBean.userDescription}" autoResize="false"
						requiredMessage="English description is required." />
						
				<h:outputLabel for="source" value="Query source: " />
				<p:inputTextarea rows="2" cols="35" id="source" required="true" style="resize:none"
						value="#{freeEntryPageBean.source}" autoResize="false"
						requiredMessage="Query source is required." />
				
				<f:facet name="footer">
					<p:commandButton id="addQueryButton"
						action="#{freeEntryPageBean.addQuery}"
						update="freeEntryForm" 
						value="Add" icon="ui-icon-check" style="margin:0"/>
				</f:facet> 
			</p:panelGrid>
		</div>
		<div style="position:absolute;width:600;height:400;top:auto;left:475">
			<p:commandButton id="databaseButton" value="Show Schema" />
			<p:overlayPanel id="databasePanel" for="databaseButton" hideEffect="fade"> 
					<p:dataTable var="databaseTable"
						value="#{freeEntryPageBean.tables}">
						<p:column headerText="Table Names">
							<h:outputText value="#{databaseTable.tableName}" />
						</p:column>
						<p:column headerText="Column Names" width="400" style="white-space: normal;">
							<h:outputText value="#{databaseTable.columns}" />
						</p:column>
					</p:dataTable>
			</p:overlayPanel> 
			<ui:remove>
			<p:commandButton id="resultSetButton" value="Show Result Set" />
			<p:overlayPanel id="resultSetPanel" for="resultSetButton" hideEffect="fade"> 
					<p:dataTable id="resultsTable" var="row"
						value="#{freeEntryPageBean.queryResult.data}">
						<p:columns value="#{freeEntryPageBean.queryResult.columns}"
							var="column" columnIndexVar="columnIndex">
							<f:facet name="header">
									#{column}
								</f:facet>
								#{row[columnIndex]}
							</p:columns>
					</p:dataTable>
			</p:overlayPanel> 
			</ui:remove>
			<p:messages />
		</div>
		<div style="position:absolute;height:500;top:400;left:0">
		<br/><br/>
			<p:dataTable id="userQueriesTable" var="query" scrollable="true" scrollHeight="300" 
					value="#{freeEntryPageBean.userQueries}" style="width:1000">
				<p:column headerText="Schema" style="width:75">
					<h:outputText value="#{query.schema}" />
				</p:column>
				<p:column headerText="Source" style="width:125">
					<h:outputText value="#{query.source}" />
				</p:column>
				<p:column headerText="Query" style="width:300">
					<h:outputText value="#{query.query}" />
				</p:column>
				<p:column headerText="English" style="width:300">
					<h:outputText value="#{query.userDescription}" />
				</p:column>
			</p:dataTable>
		</div>
	</h:form>
</h:body>
</html>