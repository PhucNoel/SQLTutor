<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<f:event type="preRenderView" listener="#{userBean.homepageRedirect}" />
<h:head>
	<title>SQL Tutor</title>
	<ui:insert name="menu">
		<ui:include src="/samples/template-menubar.xhtml" />
	</ui:insert>
</h:head>
<h:body style="height:1000px;width:1400px;margin-left:20px">
	<h:form id="queryEntryForm">
		<p:commandButton id="databaseButton" value="Show Schema" />
		<p:overlayPanel id="databasePanel" for="databaseButton" hideEffect="fade"> 
				<p:dataTable var="databaseTable"
					value="#{queryEntryPageBean.tables}">
					<p:column headerText="Table Names">
						<h:outputText value="#{databaseTable.tableName}" />
					</p:column>
					<p:column headerText="Column Names" width="400" style="white-space: normal;">
						<h:outputText value="#{databaseTable.columns}" />
					</p:column>
				</p:dataTable>
		</p:overlayPanel> 
		<!-- 
    	<p:commandButton id="schemaDiagramButton" value="Schema Diagram" type="button" />
	    <p:overlayPanel id="schemaDiagramPanel" for="schemaDiagramButton" hideEffect="fade">
			<div style="width:450;height:600;">
				<p:graphicImage value="/images/schema/companydatabase.png"/>  
				<br/>
			</div>  
	    </p:overlayPanel>
	    --> 
		<div style="position:absolute;width:1000px;height:400px;top:auto;left:20px">
			<p:panelGrid columns="2">
				<f:facet name="header">  
				    Try Queries
				</f:facet>
				<p:outputLabel for="query" value="Enter Query:"/>
				<p:inputTextarea rows="5" cols="100" id="query" reRender="results"
					autoResize="false" style="resize:none" value="#{queryEntryPageBean.query}" 
					requiredMessage="Query entry is required." />
				<f:facet name="footer">
					<p:commandButton id="queryEntryButton"
						action="#{queryEntryPageBean.processSQL}"
						update="queryEntryForm" 
						value="Submit" icon="ui-icon-check" style="margin:0"/>
				</f:facet> 
			</p:panelGrid>
		</div>
		<style type="text/css"> 
		#defaultTable {position:absolute;top:300px;left:20px;width:1000px;}	
		#wideTable {position:absolute;top:300px;left:20px;width:2000px;}
		</style>
		<div id="#{queryEntryPageBean.highColumnCount() ? 'wideTable' : 'defaultTable'}">
			<br/><h2>Query Result:</h2>
			<p:dataTable id="resultsTable" var="row" scrollable="true" scrollHeight="200"  scrollWidth="1000"
				value="#{queryEntryPageBean.queryResult.data}" rendered="#{!queryEntryPageBean.getQueryMalformed()}">
				<p:columns value="#{queryEntryPageBean.queryResult.columns}" style="white-space: normal;"
					var="column" columnIndexVar="columnIndex" >
					<f:facet name="header">
						#{column}
					</f:facet>
					#{row[columnIndex]}
				</p:columns>
			</p:dataTable>
			<h:outputText id="results" value="#{queryEntryPageBean.feedbackNLP}" style="width: 450px!important; display:block!important;" escape="false"
				rendered="#{queryEntryPageBean.getQueryMalformed()}" />
			<p:messages />
		</div>
	</h:form>
</h:body>
</html>