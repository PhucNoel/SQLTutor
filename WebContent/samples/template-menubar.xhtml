<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<!-- Tutorial, schema options, and NLP Feedback Sample should be rendered="#{userBean.isLoggedIn()}" -->
	<h:form>
		<p:menubar autoDisplay="false">
			<p:menuitem>
				<p:outputLabel value="SQL Tutor" style="margin-right:40px; margin-left:20px" />
			</p:menuitem>
			<p:submenu label="Navigation" icon="ui-icon-folder-open" style="margin-right:10px;"> 
				<p:menuitem value="Home" icon="ui-icon-arrow-1-e" action="HomePage.xhtml?faces-redirect=true"/>
				<p:menuitem value="Query Entry" icon="ui-icon-arrow-1-e" action="QueryEntry.xhtml?faces-redirect=true" 
					rendered="#{userBean.isLoggedIn()}"/>
				<p:menuitem value="Tutorial" action="TutorialPage.xhtml?faces-redirect=true"
					icon="ui-icon-arrow-1-e" rendered="#{userBean.isLoggedIn()}" />
				<p:menuitem value="NLP Feedback Sample" action="SampleNLPPage.xhtml?faces-redirect=true"
					icon="ui-icon-arrow-1-e" rendered="#{userBean.isDevUser()}" />
				<p:menuitem value="Dev Query Entry" action="FreeEntryPage.xhtml?faces-redirect=true"
					icon="ui-icon-arrow-1-e" rendered="#{userBean.isDevUser()}" />
				<p:menuitem value="Schema Upload" action="SchemaUploadPage.xhtml?faces-redirect=true" 
					icon="ui-icon-arrow-1-e" rendered="#{userBean.isDevUser()}" />
				<p:submenu label="Contact Us" icon="ui-icon-contact">
					<p:menuitem value="Sumit Gulwani" icon="ui-icon-mail-closed" onclick="location.href='mailto:sumitg@microsoft.com'"/>
					<p:menuitem value="Mayur Naik" icon="ui-icon-mail-closed" onclick="location.href='mailto:naik@cc.gatech.edu'"/>
					<p:menuitem value="Jake Cobb" icon="ui-icon-mail-closed" onclick="location.href='mailto:jake.cobb@gatech.edu'"/>
					<p:menuitem value="Will Holton" icon="ui-icon-mail-closed" onclick="location.href='mailto:wholton@gatech.edu'"/>
				</p:submenu>
			</p:submenu>
			<p:menuitem value="Schema Options" icon="ui-icon-disk" type="button" style="margin-right:20px"
				onclick="PF('schema_dlg').show();" rendered="#{userBean.isDevUser()}"/>
			<p:menuitem value="Login" onclick="PF('login_dlg').show();" type="button" icon="ui-icon-arrowreturnthick-1-e"
				style="margin-right:20px" rendered="#{!userBean.isLoggedIn()}" />
			<p:menuitem value="Logout" type="button" icon="ui-icon-arrowreturnthick-1-w" ajax="false"
				style="margin-right:20px" rendered="#{userBean.isLoggedIn()}" action="#{userBean.setLoggedIn(false)}" />
			<p:menuitem value="Register" action="RegistrationPage.xhtml?faces-redirect=true" 
				icon="ui-icon-arrowreturnthick-1-e" style="margin-right:20px" rendered="#{!userBean.isLoggedIn()}"/>
	        <f:facet name="options">  
	        	<h:outputText rendered="#{userBean.isLoggedIn()}" value="Current schema: #{userBean.selectedSchemaName}"/> 
	        </f:facet>  
		</p:menubar>
	</h:form>
	<p:dialog id="schemaDialog" header="Schema options" widgetVar="schema_dlg" onHide="location.reload();"
		onshow="#{schemaSelectionBean.setSelectedSchema(userBean.selectedSchemaName)}" 
		modal="true" width="350" resizable="false" appentTo="@(body)">
		<h:form id="schemaForm">
			<h:outputText value="Current schema: #{userBean.selectedSchemaName}"/>
			<br/><br/>
			<p:panel>
				<h:panelGrid id="schemaGrid" columns="2">
					<h:outputText value="Please select a schema:" />
					<p:selectOneMenu id="schema" value="#{schemaSelectionBean.selectedSchema}" effect="fade">
						<f:selectItems value="#{schemaSelectionBean.schemas}" itemValue="#{schemaSelectionBean.schemas}"
							itemLabel="#{schemaSelectionBean.schemas}" />
					</p:selectOneMenu>	
				</h:panelGrid>
			</p:panel>
			<br/><br/>
			<p:commandButton value="Submit" update="schemaForm" 
				action="#{userBean.setSelectedSchema(schemaSelectionBean.selectedSchema)}"
				oncomplete="PF('schema_dlg').hide()"   
				style="float:right">
			</p:commandButton>
			
		</h:form>
	</p:dialog>
	<p:dialog id="loginDialog" header="Login" widgetVar="login_dlg" 
		modal="true" width="400" resizable="false" appendTo="@(body)">  
		<h:form id="loginForm">
			<p:panel id="loginPanel">
				<h:panelGrid id="loginGrid" columns="3">
					<h:outputLabel for="username" value="Username: " />
					<p:inputText id="username" required="true" requiredMessage="Please input your username."
						label="Username" value="#{userBean.username}">
						<f:validateLength minimum="3" maximum="12" />
					</p:inputText>
					<br/>
					<h:outputLabel for="password" value="Password: " />
					<p:password id="password" required="true" label="Password"
						requiredMessage="Please input your password." value="#{userBean.password}">
						<f:validateLength minimum="3" maximum="12" />
					</p:password>
					<br/>
				</h:panelGrid>
				<p:messages id="loginMessages"/>
			</p:panel>
			<!-- Temporarily disabling catcha. When re-enabled, disable 'alternativeButton'. -->
			<ui:remove>
			<p:captcha label="Captcha" theme="white" required="true" 
				requiredMessage="Captcha is required." validatorMessage="Captcha text did not match." secure="true"/> 
			<p:commandButton value="Submit" update="loginPanel" action="#{userBean.login}" 
				oncomplete="Recaptcha.reload()" onerror="Recaptcha.reload()" />
			</ui:remove>
			<p:commandButton id="alternativeButton" value="Submit" update="loginPanel" action="#{userBean.login()}"/>
		</h:form>
	</p:dialog>
</html>