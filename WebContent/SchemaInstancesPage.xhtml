<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
	<f:event type="preRenderView" listener="#{userBean.devRedirect}" />
	<h:head>
		<title>SQL Tutor</title>
		<ui:insert name="menu">
			<ui:include src="/Menubar.xhtml" />
		</ui:insert>
	</h:head>
	<h:body style="height:1000px;width:1400px;margin-left:20px">
		<h:form>
			<div style="position:absolute;width:400;top:auto;left:20">
				<p:commandButton id="databaseButton" value="Show Schema" />
				<p:overlayPanel id="databasePanel" for="databaseButton" hideEffect="fade"> 
						<p:dataTable var="databaseTable"
							value="#{schemaInstancesPageBean.tables}">
							<p:column headerText="Table Names" style="font-size:16px">
								<p:outputLabel style="font-size:16px" value="#{databaseTable.tableName}" />
							</p:column>
							<p:column headerText="Column Names" style="white-space: normal;">
								<h:outputText style="font-size:16" value="#{databaseTable.columns}" />
							</p:column>
						</p:dataTable>
				</p:overlayPanel> 
				<br/><br/>
				<h:link value="Schema Options" outcome="SchemaOptionsPage" style="font-size:18px"/>
				<br/><br/>
				<h:outputText style="font-size:18" value="Schema Instances" />
				<br/><br/>
				<h:link value="Schema Questions" outcome="SchemaQuestionsPage" style="font-size:18px"/>			
			</div>
			<div style="position:absolute;width:1000;top:auto;left:420">
		    	<p:messages />
		    	
		 		<p:panel >
					<f:facet name="header">
						<h:outputText style="font-size:16" value="Use this to view the instance's data. Columns are resizable."/>
					</f:facet>
					
				    <p:tabView value="#{schemaInstancesPageBean.tables}" var="table" scrollable="true"
				    	dynamic="true">
				        <p:tab id="tab" title="#{table.tableName}">
							<p:dataTable id="data" var="row" scrollable="true" scrollWidth="90%" scrollHeight="90%"
								style="width:1000;height:300"
								value="#{schemaInstancesPageBean.tableData[table.tableName].data}" 
								resizableColumns="true">
								<p:columns value="#{schemaInstancesPageBean.tableData[table.tableName].columns}" style="white-space: normal;"
									var="column" columnIndexVar="columnIndex">
									<f:facet name="header">
										<p:outputLabel style="font-weight:bold; font-size:16px"
											value="#{column}"/>
									</f:facet>
									<p:outputLabel style="font-size:16px"
											value="#{row[columnIndex]}"/>
								</p:columns>
							</p:dataTable>
				        </p:tab>
				    </p:tabView>
				</p:panel>
				<br/><br/>
				
				<p:panel >
					<f:facet name="header">
						<h:outputText style="font-size:16" value="Use this text entry box to alter and query the instance:" />
					</f:facet>
					<p:inputTextarea rows="5" cols="115" id="query" reRender="results" style="resize:none"
						autoResize="false" value="#{schemaInstancesPageBean.query}" />
					<br/>
					<p:commandButton id="try" value="Submit"
						action="#{schemaInstancesPageBean.processSQL}"
						ajax="false"
						style="margin-top:5"/>
	
					<br/><br/>
					<p:panel >
						<f:facet name="header">
							<p:outputLabel for="resultsTable" style="font-size:20;font-weight:bold" value="Result Set:"/>
						</f:facet>
						<p:dataTable id="resultsTable" var="row" scrollable="true" scrollHeight="200"
							value="#{schemaInstancesPageBean.queryResult.data}">
							<p:columns value="#{schemaInstancesPageBean.queryResult.columns}" style="white-space: normal;"
								var="column" columnIndexVar="columnIndex">
								<f:facet name="header">
									<h:outputText style="font-weight:bold; font-size:16px"
										value="#{column}"/>
								</f:facet>
								<h:outputText style="font-size:16px"
										value="#{row[columnIndex]}"/>
							</p:columns>
						</p:dataTable>
					</p:panel>
				</p:panel>
			</div>
		</h:form>
	</h:body>
</html>