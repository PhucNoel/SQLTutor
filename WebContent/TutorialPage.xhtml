<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<f:event type="preRenderView" listener="#{tutorialBean.loginRedirect}" />
<h:head>
	<title>SQL Tutor</title>
	<ui:insert name="menu">
		<ui:include src="/samples/template-menubar.xhtml" />
	</ui:insert>
</h:head>
<h:body style="height:1000px;width:1400px">
	<h:form id="form">
		<div style="position:absolute;width:700;height:500;top:auto;left:0">
			<h2>Question:</h2>
			<h:outputText id="question" value="#{tutorialBean.question}" />
			<br/>
			<h2>Database:</h2>
			<p:dataTable var="databaseTable"
				value="#{tutorialBean.tables}">
				<p:column headerText="Table Names" width="100">
					<h:outputText value="#{databaseTable.tableName}" />
				</p:column>
				<p:column headerText="Column Names" width="400" style="white-space: normal;">
					<h:outputText value="#{databaseTable.columns}" />
				</p:column>
			</p:dataTable>

			<h2>Query input:</h2>
			<p:inputTextarea rows="5" cols="30" id="query" reRender="results" style="resize:none"
				autoResize="false" value="#{tutorialBean.query}" />
			<br/>
			<p:commandButton id="try" value="Try Query"
				action="#{tutorialBean.processSQL}" 
				update="form" />
			<p:commandButton id="next" value="Next Question"
				action="#{tutorialBean.nextQuestion}"
				update="form"/>
		</div>

		<div style="position:absolute;width:700;height:500;top:auto;left:710">
			<h2>Query Result:</h2>
			<p:dataTable id="resultsTable" var="row" scrollable="true" scrollHeight="200"
				value="#{tutorialBean.queryResult.data}" >
				<p:columns value="#{tutorialBean.queryResult.columns}" style="white-space: normal;"
					var="column" columnIndexVar="columnIndex">
					<f:facet name="header">
						#{column}
					</f:facet>
					#{row[columnIndex]}
				</p:columns>
			</p:dataTable>
			<h2>Feedback:</h2>
			<ui:param name="queryIsCorrectFeedback" value="#{tutorialBean.resultSetFeedback}"/>
			<ui:param name="queryisIncorrectFeedback" value="#{tutorialBean.resultSetFeedback} #{tutorialBean.feedbackNLP}"/>
			<h:outputText id="resultSetFeedback" value="#{tutorialBean.getQueryIsCorrect() ? queryIsCorrectFeedback : queryisIncorrectFeedback}"
				style="width: 700px;white-space: pre;" escape="false"/>
			<br/>
			<h:outputText value="Your result should resemble this example:" rendered="#{!tutorialBean.getQueryIsCorrect()}"/>
			<p:commandButton id="answerButton" value="Example Answer" rendered="#{!tutorialBean.getQueryIsCorrect()}"/>
			<p:overlayPanel id="answerPanel" for="answerButton" hideEffect="fade"> 
				<p:dataTable id="answerTable" var="row" scrollable="true" scrollHeight="200"
					value="#{tutorialBean.answerResult.data}" >
					<p:columns value="#{tutorialBean.answerResult.columns}" style="white-space: normal;"
						var="column" columnIndexVar="columnIndex">
						<f:facet name="header">
							#{column}
						</f:facet>
						#{row[columnIndex]}
					</p:columns>
				</p:dataTable>
			</p:overlayPanel>
		</div>
	</h:form>
</h:body>
</html>