<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui">
<f:event type="preRenderView" listener="#{tutorialBean.loginRedirect}" />
<h:head>
	<title>SQL Tutor</title>
	<ui:insert name="menu">
		<ui:include src="/samples/template-menubar.xhtml" />
	</ui:insert>
</h:head>
<h:body style="height:1000px;width:1600px">
	<h:form>
		<div style="float: left; width: 50%;">
			<h2>Question:</h2>
			<h:outputText id="question" value="#{tutorialBean.question}" />
			<br/>
			<h2>Database:</h2>
			<p:dataTable var="databaseTable" scrollable="true" scrollHeight="200"
				value="#{tutorialBean.tables}">
				<p:column headerText="Table Names">
					<h:outputText value="#{databaseTable.tableName}" />
				</p:column>
				<p:column headerText="Column Names" style="width:200px; white-space: normal;">
					<h:outputText value="#{databaseTable.columns}" />
				</p:column>
			</p:dataTable>

			<h2>Query input:</h2>
			<p:inputTextarea rows="6" cols="33" id="query" reRender="results"
				autoResize="false" value="#{tutorialBean.query}" />
			<br/>
			<p:commandButton id="try" value="Try Query"
				action="#{tutorialBean.processSQL}" 
				update="resultSetFeedback,feedbackNLP,:#{p:component('resultsTable')}" />
			<p:commandButton id="next" value="Next Question"
				action="#{tutorialBean.nextQuestion}"
				update="resultSetFeedback,feedbackNLP,:#{p:component('resultsTable')},question" />
		</div>

		<div style="float: right; width: 49%;">
			<h2>Result Set Feedback:</h2>
			<h:outputText id="resultSetFeedback" value="#{tutorialBean.resultSetFeedback}"
				style="white-space: pre;" escape="false" />
			
			<h2>NLP Feedback:</h2>
			<h:outputText id="feedbackNLP" value="#{tutorialBean.feedbackNLP}"
				style="white-space: pre;" escape="false" />

			<h2>Query Result:</h2>
			<p:dataTable id="resultsTable" var="row" scrollable="true" scrollHeight="200"
				value="#{tutorialBean.queryResult.data}">
				<p:columns value="#{tutorialBean.queryResult.columns}"
					var="column" columnIndexVar="columnIndex">
					<f:facet name="header">
							#{column}
						</f:facet>
						#{row[columnIndex]}
					</p:columns>
			</p:dataTable>
		</div>
	</h:form>
</h:body>
</html>